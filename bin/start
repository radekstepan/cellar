#!/usr/bin/env bash
# Start the Docker container

# Go to the root of the project
cd "$(dirname "$0")/.."

echo "Starting the application..."
docker-compose up -d --remove-orphans

echo "Waiting for server to respond..."
for i in {1..5}; do
  if curl -s http://localhost:3001/api/schema >/dev/null; then
    echo "SUCCESS: Container successfully started."
    echo "STATUS: RUNNING"
    echo "Application and API are available at http://localhost:3001"
    exit 0
  fi
  sleep 1
done

echo "ERROR: Failed to start the container or server isn't responding."
echo "STATUS: STOPPED"
exit 1
